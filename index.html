<!DOCTYPE html>
<html>
<head>
  <title>Car MPG Analysis - Narrative Visualization</title>
  <style>
    /* Add your CSS styling here */
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    svg {
      border: 1px solid #ccc;
    }
    .annotation {
      font-size: 12px;
      text-anchor: middle;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Car MPG Analysis</h1>

    <!-- Scene 1: Introduction -->
    <h2>Scene 1: Introduction</h2>
    <p>
      The opening scene introduces the car enthusiast and sets the context for the exploration of engine cylinders and MPG.
      A brief explanation of the dataset and its variables (Make, Fuel, Engine Cylinders, Average Highway MPG, and Average City MPG) is provided.
    </p>

    <!-- Scene 2: Engine Cylinders vs. MPG Scatter Plot -->
    <h2>Scene 2: Engine Cylinders vs. MPG</h2>
    <div id="chart-container-2">
      <!-- Engine Cylinders vs. MPG chart will be appended here -->
    </div>

    <!-- Scene 3: City MPG Analysis -->
    <h2>Scene 3: City MPG Analysis</h2>
    <div id="chart-container-3">
      <!-- City MPG chart will be appended here -->
    </div>

    <!-- Scene 4: Conclusion and Takeaways -->
    <h2>Scene 4: Conclusion and Takeaways</h2>
    <div>
      <p>
        After exploring the data, we can draw the following conclusions and takeaways:
      </p>
      <ul>
        <li>Gasoline-powered cars generally have a wide range of MPG values based on engine cylinders.</li>
        <li>Diesel-powered cars tend to have higher MPG values for both city and highway driving.</li>
        <li>Electric cars stand out for their high MPG in the city, making them efficient in urban environments.</li>
        <li>Smaller engine cylinders often lead to better city MPG, while larger cylinders can provide higher highway MPG.</li>
      </ul>
    </div>

    <!-- Scene 5: Fuel Type Comparison -->
    <h2>Scene 5: Fuel Type Comparison</h2>
    <div>
      <label for="fuel-type">Select Fuel Type:</label>
      <select id="fuel-type">
        <option value="Gasoline">Gasoline</option>
        <option value="Diesel">Diesel</option>
        <option value="Electricity">Electricity</option>
      </select>
    </div>
    <div id="chart-container-5">
      <!-- Fuel Type Comparison chart will be appended here -->
    </div>
  </div>

  <script src="https://d3js.org/d3.v6.min.js"></script>
  <script src="https://unpkg.com/d3-annotation@2.3.0/dist/d3-annotation.min.js"></script>
  <script>
    // Load the CSV data from your GitHub repository using d3.csv and await
    async function loadData() {
      try {
        const response = await d3.csv('https://github.com/shiz4-illinois/shiz4-illinois.github.io/blob/main/cars2017.csv');
        return response;
      } catch (error) {
        console.error('Error loading CSV:', error);
      }
    }

    // Call the loadData function and handle the dataset
    loadData().then(dataset => {
      // Your D3 code here...
      console.log(dataset); // Check if the dataset is loaded successfully

      // Rest of your D3 code for building the narrative visualization with the dataset...

      // Scene 2: Engine Cylinders vs. MPG Scatter Plot
      // ... Your D3 code for Scene 2 ...
      <!-- Scene 2: Engine Cylinders vs. MPG Scatter Plot -->
<h2>Scene 2: Engine Cylinders vs. MPG</h2>
<div id="chart-container-2">
  <!-- Engine Cylinders vs. MPG chart will be appended here -->
</div>

<script>
  // Create the Engine Cylinders vs. MPG chart
  const svgEngineCylinders = d3.select('#chart-container-2')
    .append('svg')
    .attr('width', 800)
    .attr('height', 400)
    .append('g')
    .attr('transform', 'translate(50, 50)');

  // Access the loaded dataset
  loadData().then(dataset => {
    // Define the scales for the x and y axes for Engine Cylinders vs. MPG chart
    const xScaleEngineCylinders = d3.scaleLinear()
      .domain([0, d3.max(dataset, d => d.EngineCylinders)])
      .range([0, 700]);

    const yScaleMPG = d3.scaleLinear()
      .domain([0, d3.max(dataset, d => Math.max(d.AverageHighwayMPG, d.AverageCityMPG))])
      .range([300, 0]);

    // Create circles for each data point
    const circles = svgEngineCylinders.selectAll('circle')
      .data(dataset)
      .enter()
      .append('circle')
      .attr('cx', d => xScaleEngineCylinders(d.EngineCylinders))
      .attr('cy', d => yScaleMPG(d.AverageHighwayMPG)) // You can use AverageCityMPG here too
      .attr('r', 5)
      .style('fill', 'blue');

    // Add labels for car makes
    const labels = svgEngineCylinders.selectAll('text')
      .data(dataset)
      .enter()
      .append('text')
      .attr('x', d => xScaleEngineCylinders(d.EngineCylinders) + 10)
      .attr('y', d => yScaleMPG(d.AverageHighwayMPG) + 5) // You can use AverageCityMPG here too
      .text(d => d.Make)
      .style('font-size', '10px');

    // Add axis labels
    svgEngineCylinders.append('text')
      .attr('transform', 'translate(350, 350)')
      .style('text-anchor', 'middle')
      .text('Engine Cylinders');

    svgEngineCylinders.append('text')
      .attr('transform', 'rotate(-90)')
      .attr('y', -30)
      .attr('x', -150)
      .style('text-anchor', 'middle')
      .text('MPG');
  };
</script>

      // Scene 3: City MPG Analysis
      // ... Your D3 code for Scene 3 ...

      // Scene 5: Fuel Type Comparison
      // ... Your D3 code for Scene 5 ...
    });
  </script>
</body>
</html>

